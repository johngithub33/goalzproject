<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=, initial-scale=1.0">
    <title>Goalz</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet"> 

    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">
    <link rel="stylesheet" type='text/css' href="./public/style.css">
</head>

<body>

    <form id='loginform' action="/formsubmission" method="post" novalidate>
        
        <div>
            <label for="fname"> first name: </label>
            <input type="text" id="fname" name="fname" > 
        </div>

        <div>
            <label for="lname"> last name: </label>
            <input type="text" id="fname" name="fname" > 
        </div>

        
        <div>
                <div>
                    <label for="email"> email: </label>
                    <input id="email" type="email" name="email" required>
                    <span class='error' aria-live="polite"></span>
                </div>
        </div>

        <input type="submit" value='submit button'>
        <input type="button" value='button button'>
    </form>


    <script>
        
        //utils
        var pr = (x) => console.log(x);
        var qs = (x) => document.querySelector(x);
        var emailRgxStr = /\S+@\S+[.]\S/;


        // var getText = qs('input')
        // var showText = qs('.displaytext')
        // var getBtn = qs('.regexbutton');
        // var matchText = qs('.showmatch');
        // var globalCurrStr = '';

        //events: focus, input, focusout
        //erase placeholder text on initial focus // focus: getText.value = '';
        //input: showText.textContent = getText.value
        //focusout: //erase all text when lose focus to start over
        //click on getBtn: use emailRgsStr.text(globalCurrStr)


        //***********************************************
        //main form section
        var getForm = qs('#loginform')
        var firstName = getForm.children[0].children[1];
        var formSubmitBtn = getForm.children[3];
        var formBtnBtn = getForm.children[5];

        var globalMatch = false;

            //form overall
            getForm.addEventListener('submit', (e) => {
                //e.preventDefault();
                
                if(!globalMatch){
                    // e.preventDefault();
                }
            })
            
            //input field
            firstName.addEventListener('focus', () => { firstName.value = ''; })

            //gets text character by character as you type in the box
            firstName.addEventListener('input', () => {
                if(emailRgxStr.test(firstName.value))
                {
                    pr('match')
                    globalMatch = true;
                } else {
                    pr('no match') 

                }
            })

            firstName.addEventListener('focusout', () => { 
                // formInput.value = 'input here';
            })

            //submit btn
            formSubmitBtn.addEventListener('submit', (e) => {
                pr(formInput.value)
            })

        //VALIDITY
        //test custom error messages
        var emailfield = qs('#email')

        //.validity object is internal JS error checking
        var emailfieldValid = !emailfield.validity.typeMismatch;
        
        //selects the span under id=email
        const emailErrorText = document.querySelector('#email + span.error');

        //check during input
        email.addEventListener('input', () => {

            emailfieldValid = !emailfield.validity.typeMismatch; 

            //if field input not valid
            if(!emailfieldValid)
            {
                //text that appears in red if error during input
                emailErrorText.textContent = 'james custom error'
                
                //insert span class
                emailErrorText.className = 'error active'
            }

            else{
                emailErrorText.textContent = 'no error so far';
                emailErrorText.className = 'error';
            }
        });

        

        



    </script>

</body>
</html>